# ドメイン駆動設計入門
- ドメイン駆動設計とは
ドメインの知識を焦点をあてた設計手法。

- ドメインとは何か？
「領域」の意味を持った言葉。
ソフトウェア開発におけるドメインは、「プログラムを適用する対象となる領域」を指す。

## ドメインに含まれるものは何か？
会計システムや物流システムなどでは違った概念が登場する。
ドメインに含まれるものは、システムが対象とするものや領域によって大きく変化します。

## 知識に焦点をあてるとはどういうことか？
ソフトウェアにはその利用者が存在する。
ソフトウェアの目的はその利用者のドメインにおける何らかの問題解決。

問題を解決するためには問題を正確に理解することが必要。
技術的なアプローチで解決を図ろうとするのではなく、問題と向き合うこと。

ドメインと向き合い、そこに渦巻く知識に焦点をあてる。
よく観察しよく表現すること。

ドメイン駆動設計は、当たり前を当たり前に実践するための開発手法。

## ドメインモデルとは何か
モデルとは現実の事象あるいは概念を抽象化した概念。
抽象化する作業はモデリングと呼ばれる。

モデルは現実を全て忠実に再現しているわけではない。
必要におうじて取捨選択を行う。
何を取捨選択するかはドメインによる。

## パターン
知識を表現するパターン
- 値オブジェクト
- エンティティ
- ドメインサービス

アプリケーションを実現するためのパターン
- リポジトリ
- アプリケーションサービス
- ファクトリ

知識を表現する、より発展的なパターン
- 集約
- 仕様

### 値オブジェクト
代表的な性質
- 不変である
- 交換が可能である
- 等価性によって比較される

不変のメリット
- 状態変化によるバグに対する防衛策になる
- 並行、並列処理

不変のデメリット
- オブジェクトの値を一部変更したい場合、新しくインスタンスを生成する必要がある。

#### 値オブジェクトにする基準
どこまでを値オブジェクトにするかは難しい問題。
単純にドメインモデルとして定義される概念でない場合は迷いをうむ。

1つの基準として
- そこにルールが存在しているか
- それ単体で取扱いたいか

FullNameは定義するが、LastName、FirstNameとして定義するかどうか？
FullName（Name, Name）などNameとして扱うか？
FullNameでルールを担保するか？

などの判断は難しい。

重要なのは値オブジェクトを避けることではない。
値オブジェクトにすべきかどうかを見極めて、そうすべきと判断したら大胆に実行すべきであること。

#### 振る舞いをもった値オブジェクト
バグは思い違いから始まる。
計算処理にルールを記述し、それにそぐわない操作をはじくようにする。
システマチックに誤った操作を防止できるならそれを活用する。

値オブジェクトは決してただのデータ構造体のことを指しているのではない。
自身に関するルールを語るドメインオブジェクトらしさを帯びる。

定義されないからこそわかる。
定義されないことで、暗にそれができないことを示すことができる。

#### 値オブジェクトの採用
クラスファイルが増加することになる。
プリミティブな値になれていると抵抗を感じることもある。

どういった動機で値オブジェクトを採用するのか
- 表現力を増す
- 不正な値を存在させない
- 誤った代入を防ぐ
- ロジックの散財を防ぐ
これらは単純なことながら、システムを強力に保護することができる
